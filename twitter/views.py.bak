from django.shortcuts import render
from django.shortcuts import render_to_response
from django.http import HttpResponseRedirect
from django.template import RequestContext
from django.views.decorators.csrf import csrf_exempt
from twitter.models import User
from django.core.exceptions import ObjectDoesNotExist
from django.db import connection

# Create your views here.
def mainPage(request):
	return render_to_response('mainPage2.html')

@csrf_exempt
def login(request):
    request_context = RequestContext(request)

	if request.method=='POST':
		username=request.POST.get('username')
		passwd=request.POST.get('passwd')

		try:
			User.objects.get(userName=username)
			try:
				User.objects.get(passwd=passwd)
				return render_to_response('userpage.html',{'user':user,'passwd':passwd})
			except ObjectDoesNotExist:
				print "wrong username or password"
		except ObjectDoesNotExist:
			print "wrong username or password"
		return render(request,'mainPage2.html')
    
    if request.method=='POST':
         user=request.POST.get('username')
         passwd=request.POST.get('passwd')

     	 try:
     		  User.objects.get(userName=user)
     		  try:
     			   User.objects.get(passwd=passwd)
     			   return render_to_response('userpage.html',{'user':user,'passwd':passwd})
     		  except ObjectDoesNotExist:
     		 	   print "wrong username or password"
     	 except ObjectDoesNotExist:
     		  print "wrong username or password"
	     return render(request,'mainPage2.html')

@csrf_exempt
def addUser(request):
	request_context = RequestContext(request)

	if request.method=='POST':
		fullname=request.POST['fullname']
		email=request.POST['email']
		passwd=request.POST['passwd']
		p1=User(userName=fullname,nikename=email,passwd=passwd)
		p1.save()
		
	return render_to_response('mainPage2.html')
